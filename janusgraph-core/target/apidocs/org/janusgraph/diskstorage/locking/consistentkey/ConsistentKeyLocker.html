<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="zh">
<head>
<!-- Generated by javadoc (15) on Fri Nov 26 15:13:43 CST 2021 -->
<title>ConsistentKeyLocker (JanusGraph-Core: Core Library for JanusGraph 0.6.0 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2021-11-26">
<meta name="description" content="declaration: package: org.janusgraph.diskstorage.locking.consistentkey, class: ConsistentKeyLocker">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var data = {"i0":10,"i1":10,"i2":10};
var tabs = {65535:["t0","\u6240\u6709\u65B9\u6CD5"],2:["t2","\u5B9E\u4F8B\u65B9\u6CD5"],8:["t4","\u5177\u4F53\u65B9\u6CD5"]};
var altColor = "alt-color";
var rowColor = "row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>您的浏览器已禁用 JavaScript。</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar.top">
<div class="skip-nav"><a href="#skip.navbar.top" title="跳过导航链接">跳过导航链接</a></div>
<ul id="navbar.top.firstrow" class="nav-list" title="导航">
<li><a href="../../../../../index.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="nav-bar-cell1-rev">类</li>
<li><a href="class-use/ConsistentKeyLocker.html">使用</a></li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../../index-all.html">索引</a></li>
<li><a href="../../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>概要:&nbsp;</li>
<li><a href="#nested.class.summary">嵌套</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">字段</a>&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="sub-nav-list">
<li>详细资料:&nbsp;</li>
<li><a href="#field.detail">字段</a>&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip.navbar.top">
<!--   -->
</span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">程序包</span>&nbsp;<a href="package-summary.html">org.janusgraph.diskstorage.locking.consistentkey</a></div>
<h1 title="类 ConsistentKeyLocker" class="title">类 ConsistentKeyLocker</h1>
</div>
<div class="inheritance" title="继承树"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="java.lang中的类或接口" class="external-link">java.lang.Object</a>
<div class="inheritance"><a href="../AbstractLocker.html" title="org.janusgraph.diskstorage.locking中的类">org.janusgraph.diskstorage.locking.AbstractLocker</a>&lt;<a href="ConsistentKeyLockStatus.html" title="org.janusgraph.diskstorage.locking.consistentkey中的类">ConsistentKeyLockStatus</a>&gt;
<div class="inheritance">org.janusgraph.diskstorage.locking.consistentkey.ConsistentKeyLocker</div>
</div>
</div>
<section class="description">
<dl class="notes">
<dt>所有已实现的接口:</dt>
<dd><code><a href="../Locker.html" title="org.janusgraph.diskstorage.locking中的接口">Locker</a></code></dd>
</dl>
<hr>
<pre>public class <span class="type-name-label">ConsistentKeyLocker</span>
extends <a href="../AbstractLocker.html" title="org.janusgraph.diskstorage.locking中的类">AbstractLocker</a>&lt;<a href="ConsistentKeyLockStatus.html" title="org.janusgraph.diskstorage.locking.consistentkey中的类">ConsistentKeyLockStatus</a>&gt;
implements <a href="../Locker.html" title="org.janusgraph.diskstorage.locking中的接口">Locker</a></pre>
<div class="block">A global <a href="../Locker.html" title="org.janusgraph.diskstorage.locking中的接口"><code>Locker</code></a> that resolves inter-thread lock contention via
 <a href="../AbstractLocker.html" title="org.janusgraph.diskstorage.locking中的类"><code>AbstractLocker</code></a> and resolves inter-process contention by reading and
 writing lock data using <a href="../../keycolumnvalue/KeyColumnValueStore.html" title="org.janusgraph.diskstorage.keycolumnvalue中的接口"><code>KeyColumnValueStore</code></a>.
 <p>
 <h2>Protocol and internals</h2>
 <p>
 Locking is done in two stages: first between threads inside a shared process,
 and then between processes in a JanusGraph cluster.
 <p>
 <h3>Inter-thread lock contention</h3>
 <p>
 Lock contention between transactions within a shared process is arbitrated by
 the <code>LocalLockMediator</code> class. This mediator uses standard
 <code>java.util.concurrent</code> classes to guarantee that at most one thread
 holds a lock on any given <a href="../../util/KeyColumn.html" title="org.janusgraph.diskstorage.util中的类"><code>KeyColumn</code></a> at any given time. The code that
 uses a mediator to resolve inter-thread lock contention is common to multiple
 <code>Locker</code> implementations and lives in the abstract base class
 <a href="../AbstractLocker.html" title="org.janusgraph.diskstorage.locking中的类"><code>AbstractLocker</code></a>.
 <p>
 However, the mediator has no way to perform inter-process communication. The
 mediator can't detect or prevent a thread in another process (potentially on
 different machine) acquiring the same lock. This is addressed in the next
 section.
 <p>
 <h3>Inter-process lock contention</h3>
 <p>
 After the mediator signals that the current transaction has obtained a lock
 at the inter-thread/intra-process level, this implementation does the
 following series of writes and reads to <code>KeyColumnValueStore</code> to check
 whether it is the only process that holds the lock. These Cassandra
 operations go to a dedicated store holding nothing but locking data (a
 "store" in this context means a Cassandra column family, an HBase table,
 etc.)
 <p>
 <h4>Locking I/O sequence</h4>
 <p>
 <ol>
 <li>Write a single column to the store with the following data
 <dl>
 <dt>key</dt>
 <dd><a href="../../util/KeyColumn.html#getKey()"><code>KeyColumn.getKey()</code></a> followed by <a href="../../util/KeyColumn.html#getColumn()"><code>KeyColumn.getColumn()</code></a>.</dd>
 <dt>column</dt>
 <dd>the approximate current timestamp in nanoseconds followed by this
 process's <code>rid</code> (an opaque identifier which uniquely identify
 this process either globally or at least within the JanusGraph cluster)</dd>
 <dt>value</dt>
 <dd>the single byte 0; this is unused but reserved for future use</dd>
 </dl>
 </li>
 <li>If the write failed or took longer than <code>lockWait</code> to complete
 successfully, then retry the write with an updated timestamp and everything
 else the same until we either exceed the configured retry count (in which
 case we abort the lock attempt) or successfully complete the write in less
 than <code>lockWait</code>.</li>
 <li>Wait, if necessary, until the time interval <code>lockWait</code> has passed
 between the timestamp on our successful write and the current time.</li>
 <li>Read all columns for the key we wrote in the first step.</li>
 <li>Discard any columns with timestamps older than <code>lockExpire</code>.</li>
 <li>If our column is either the first column read or is preceded only by
 columns containing our own <code>rid</code>, then we hold the lock.  Otherwise,
 another process holds the lock and we have failed to acquire it.</li>
 <li>To release the lock, we delete from the store the column that we
 wrote earlier in this sequence</li>
 </ol>
 <p>
 <p>
 As mentioned earlier, this class relies on <a href="../AbstractLocker.html" title="org.janusgraph.diskstorage.locking中的类"><code>AbstractLocker</code></a> to obtain
 and release an intra-process lock before and after the sequence of steps
 listed above.  The mediator step is necessary for thread-safety, because
 <code>rid</code> is only unique at the process level.  Without a mediator, distinct
 threads could write lock columns with the same <code>rid</code> and be unable to
 tell their lock claims apart.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested.class.summary">
<h2>嵌套类概要</h2>
<div class="member-summary">
<table class="summary-table">
<caption><span>嵌套类</span></caption>
<thead>
<tr>
<th class="col-first" scope="col">修饰符和类型</th>
<th class="col-second" scope="col">类</th>
<th class="col-last" scope="col">说明</th>
</tr>
</thead>
<tbody>
<tr class="alt-color">
<td class="col-first"><code>static class&nbsp;</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="ConsistentKeyLocker.Builder.html" title="org.janusgraph.diskstorage.locking.consistentkey中的类">ConsistentKeyLocker.Builder</a></span></code></th>
<td class="col-last">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field.summary">
<h2>字段概要</h2>
<div class="member-summary">
<table class="summary-table">
<caption><span>字段</span></caption>
<thead>
<tr>
<th class="col-first" scope="col">修饰符和类型</th>
<th class="col-second" scope="col">字段</th>
<th class="col-last" scope="col">说明</th>
</tr>
</thead>
<tbody>
<tr class="alt-color">
<td class="col-first"><code>static <a href="../../StaticBuffer.html" title="org.janusgraph.diskstorage中的接口">StaticBuffer</a></code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#LOCK_COL_END">LOCK_COL_END</a></span></code></th>
<td class="col-last">&nbsp;</td>
</tr>
<tr class="row-color">
<td class="col-first"><code>static <a href="../../StaticBuffer.html" title="org.janusgraph.diskstorage中的接口">StaticBuffer</a></code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#LOCK_COL_START">LOCK_COL_START</a></span></code></th>
<td class="col-last">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="inherited-list">
<h3 id="fields.inherited.from.class.org.janusgraph.diskstorage.locking.AbstractLocker">从类继承的字段&nbsp;org.janusgraph.diskstorage.locking.<a href="../AbstractLocker.html" title="org.janusgraph.diskstorage.locking中的类">AbstractLocker</a></h3>
<code><a href="../AbstractLocker.html#llm">llm</a>, <a href="../AbstractLocker.html#lockExpire">lockExpire</a>, <a href="../AbstractLocker.html#lockState">lockState</a>, <a href="../AbstractLocker.html#rid">rid</a>, <a href="../AbstractLocker.html#serializer">serializer</a>, <a href="../AbstractLocker.html#times">times</a></code></div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method.summary">
<h2>方法概要</h2>
<div class="member-summary" id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="active-table-tab">所有方法</button><button role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="table-tab" onclick="show(2);">实例方法</button><button role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="table-tab" onclick="show(8);">具体方法</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<table class="summary-table" aria-labelledby="t0">
<thead>
<tr>
<th class="col-first" scope="col">修饰符和类型</th>
<th class="col-second" scope="col">方法</th>
<th class="col-last" scope="col">说明</th>
</tr>
</thead>
<tbody>
<tr class="alt-color" id="i0">
<td class="col-first"><code>protected void</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#checkSingleLock(org.janusgraph.diskstorage.util.KeyColumn,org.janusgraph.diskstorage.locking.consistentkey.ConsistentKeyLockStatus,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">checkSingleLock</a></span>&#8203;(<a href="../../util/KeyColumn.html" title="org.janusgraph.diskstorage.util中的类">KeyColumn</a>&nbsp;kc,
<a href="ConsistentKeyLockStatus.html" title="org.janusgraph.diskstorage.locking.consistentkey中的类">ConsistentKeyLockStatus</a>&nbsp;ls,
<a href="../../keycolumnvalue/StoreTransaction.html" title="org.janusgraph.diskstorage.keycolumnvalue中的接口">StoreTransaction</a>&nbsp;tx)</code></th>
<td class="col-last">
<div class="block">Try to verify that the lock identified by <code>lockID</code> is already held
 by <code>tx</code>.</div>
</td>
</tr>
<tr class="row-color" id="i1">
<td class="col-first"><code>protected void</code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#deleteSingleLock(org.janusgraph.diskstorage.util.KeyColumn,org.janusgraph.diskstorage.locking.consistentkey.ConsistentKeyLockStatus,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">deleteSingleLock</a></span>&#8203;(<a href="../../util/KeyColumn.html" title="org.janusgraph.diskstorage.util中的类">KeyColumn</a>&nbsp;kc,
<a href="ConsistentKeyLockStatus.html" title="org.janusgraph.diskstorage.locking.consistentkey中的类">ConsistentKeyLockStatus</a>&nbsp;ls,
<a href="../../keycolumnvalue/StoreTransaction.html" title="org.janusgraph.diskstorage.keycolumnvalue中的接口">StoreTransaction</a>&nbsp;tx)</code></th>
<td class="col-last">
<div class="block">Try to unlock/release/delete the lock identified by <code>lockID</code> and
 both held by and verified for <code>tx</code>.</div>
</td>
</tr>
<tr class="alt-color" id="i2">
<td class="col-first"><code>protected <a href="ConsistentKeyLockStatus.html" title="org.janusgraph.diskstorage.locking.consistentkey中的类">ConsistentKeyLockStatus</a></code></td>
<th class="col-second" scope="row"><code><span class="member-name-link"><a href="#writeSingleLock(org.janusgraph.diskstorage.util.KeyColumn,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">writeSingleLock</a></span>&#8203;(<a href="../../util/KeyColumn.html" title="org.janusgraph.diskstorage.util中的类">KeyColumn</a>&nbsp;lockID,
<a href="../../keycolumnvalue/StoreTransaction.html" title="org.janusgraph.diskstorage.keycolumnvalue中的接口">StoreTransaction</a>&nbsp;txh)</code></th>
<td class="col-last">
<div class="block">Try to write a lock record remotely up to the configured number of
  times.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inherited-list">
<h3 id="methods.inherited.from.class.org.janusgraph.diskstorage.locking.AbstractLocker">从类继承的方法&nbsp;org.janusgraph.diskstorage.locking.<a href="../AbstractLocker.html" title="org.janusgraph.diskstorage.locking中的类">AbstractLocker</a></h3>
<code><a href="../AbstractLocker.html#checkLocks(org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">checkLocks</a>, <a href="../AbstractLocker.html#deleteLocks(org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">deleteLocks</a>, <a href="../AbstractLocker.html#writeLock(org.janusgraph.diskstorage.util.KeyColumn,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">writeLock</a></code></div>
<div class="inherited-list">
<h3 id="methods.inherited.from.class.java.lang.Object">从类继承的方法&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="java.lang中的类或接口" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone()" title="java.lang中的类或接口" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals(java.lang.Object)" title="java.lang中的类或接口" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize()" title="java.lang中的类或接口" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass()" title="java.lang中的类或接口" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode()" title="java.lang中的类或接口" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify()" title="java.lang中的类或接口" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll()" title="java.lang中的类或接口" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString()" title="java.lang中的类或接口" class="external-link">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait()" title="java.lang中的类或接口" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long)" title="java.lang中的类或接口" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait(long,int)" title="java.lang中的类或接口" class="external-link">wait</a></code></div>
<div class="inherited-list">
<h3 id="methods.inherited.from.class.org.janusgraph.diskstorage.locking.Locker">从接口继承的方法&nbsp;org.janusgraph.diskstorage.locking.<a href="../Locker.html" title="org.janusgraph.diskstorage.locking中的接口">Locker</a></h3>
<code><a href="../Locker.html#checkLocks(org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">checkLocks</a>, <a href="../Locker.html#deleteLocks(org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">deleteLocks</a>, <a href="../Locker.html#writeLock(org.janusgraph.diskstorage.util.KeyColumn,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">writeLock</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field.detail">
<h2>字段详细资料</h2>
<ul class="member-list">
<li>
<section class="detail" id="LOCK_COL_START">
<h3>LOCK_COL_START</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="../../StaticBuffer.html" title="org.janusgraph.diskstorage中的接口">StaticBuffer</a></span>&nbsp;<span class="member-name">LOCK_COL_START</span></div>
</section>
</li>
<li>
<section class="detail" id="LOCK_COL_END">
<h3>LOCK_COL_END</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="../../StaticBuffer.html" title="org.janusgraph.diskstorage中的接口">StaticBuffer</a></span>&nbsp;<span class="member-name">LOCK_COL_END</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method.detail">
<h2>方法详细资料</h2>
<ul class="member-list">
<li>
<section class="detail" id="writeSingleLock(org.janusgraph.diskstorage.util.KeyColumn,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">
<h3>writeSingleLock</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="ConsistentKeyLockStatus.html" title="org.janusgraph.diskstorage.locking.consistentkey中的类">ConsistentKeyLockStatus</a></span>&nbsp;<span class="member-name">writeSingleLock</span>&#8203;(<span class="parameters"><a href="../../util/KeyColumn.html" title="org.janusgraph.diskstorage.util中的类">KeyColumn</a>&nbsp;lockID,
<a href="../../keycolumnvalue/StoreTransaction.html" title="org.janusgraph.diskstorage.keycolumnvalue中的接口">StoreTransaction</a>&nbsp;txh)</span>
                                           throws <span class="exceptions"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Throwable.html" title="java.lang中的类或接口" class="external-link">Throwable</a></span></div>
<div class="block">Try to write a lock record remotely up to the configured number of
  times. If the store produces
 <a href="../TemporaryLockingException.html" title="org.janusgraph.diskstorage.locking中的类"><code>TemporaryLockingException</code></a>, then we'll call mutate again to add a
 new column with an updated timestamp and to delete the column that tried
 to write when the store threw an exception. We continue like that up to
 the retry limit. If the store throws anything else, such as an unchecked
 exception or a <a href="../../PermanentBackendException.html" title="org.janusgraph.diskstorage中的类"><code>PermanentBackendException</code></a>, then we'll try to
 delete whatever we added and return without further retries.</div>
<dl class="notes">
<dt>指定者:</dt>
<dd><code><a href="../AbstractLocker.html#writeSingleLock(org.janusgraph.diskstorage.util.KeyColumn,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">writeSingleLock</a></code>&nbsp;在类中&nbsp;<code><a href="../AbstractLocker.html" title="org.janusgraph.diskstorage.locking中的类">AbstractLocker</a>&lt;<a href="ConsistentKeyLockStatus.html" title="org.janusgraph.diskstorage.locking.consistentkey中的类">ConsistentKeyLockStatus</a>&gt;</code></dd>
<dt>参数:</dt>
<dd><code>lockID</code> - lock to acquire</dd>
<dd><code>txh</code> - transaction</dd>
<dt>返回:</dt>
<dd>the timestamp, in nanoseconds since UNIX Epoch, on the lock
         column that we successfully wrote to the store</dd>
<dt>抛出:</dt>
<dd><code><a href="../TemporaryLockingException.html" title="org.janusgraph.diskstorage.locking中的类">TemporaryLockingException</a></code> - if the lock retry count is exceeded without successfully
                                   writing the lock in less than the wait limit</dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Throwable.html" title="java.lang中的类或接口" class="external-link">Throwable</a></code> - if the storage layer throws anything else</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="checkSingleLock(org.janusgraph.diskstorage.util.KeyColumn,org.janusgraph.diskstorage.locking.consistentkey.ConsistentKeyLockStatus,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">
<h3>checkSingleLock</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="member-name">checkSingleLock</span>&#8203;(<span class="parameters"><a href="../../util/KeyColumn.html" title="org.janusgraph.diskstorage.util中的类">KeyColumn</a>&nbsp;kc,
<a href="ConsistentKeyLockStatus.html" title="org.janusgraph.diskstorage.locking.consistentkey中的类">ConsistentKeyLockStatus</a>&nbsp;ls,
<a href="../../keycolumnvalue/StoreTransaction.html" title="org.janusgraph.diskstorage.keycolumnvalue中的接口">StoreTransaction</a>&nbsp;tx)</span>
                        throws <span class="exceptions"><a href="../../BackendException.html" title="org.janusgraph.diskstorage中的类">BackendException</a>,
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html" title="java.lang中的类或接口" class="external-link">InterruptedException</a></span></div>
<div class="block"><span class="descfrm-type-label">从类复制的说明:&nbsp;<code><a href="../AbstractLocker.html#checkSingleLock(org.janusgraph.diskstorage.util.KeyColumn,S,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">AbstractLocker</a></code></span></div>
<div class="block">Try to verify that the lock identified by <code>lockID</code> is already held
 by <code>tx</code>. The <code>lockStatus</code> argument refers to the object
 returned by a previous call to
 <a href="../AbstractLocker.html#writeSingleLock(org.janusgraph.diskstorage.util.KeyColumn,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)"><code>AbstractLocker.writeSingleLock(KeyColumn, StoreTransaction)</code></a>. This should be a
 read-only operation: return if the lock is already held, but this method
 finds that it is not held, then throw an exception instead of trying to
 acquire it.
 <p>
 This method is only useful with nonblocking locking implementations try
 to lock and then check the outcome of the attempt in two separate stages.
 For implementations that build <code>writeSingleLock(...)</code> on a
 synchronous locking primitive, such as a blocking <code>lock()</code> method
 or a blocking semaphore <code>p()</code>, this method is redundant with
 <code>writeSingleLock(...)</code> and may unconditionally return true.</div>
<dl class="notes">
<dt>指定者:</dt>
<dd><code><a href="../AbstractLocker.html#checkSingleLock(org.janusgraph.diskstorage.util.KeyColumn,S,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">checkSingleLock</a></code>&nbsp;在类中&nbsp;<code><a href="../AbstractLocker.html" title="org.janusgraph.diskstorage.locking中的类">AbstractLocker</a>&lt;<a href="ConsistentKeyLockStatus.html" title="org.janusgraph.diskstorage.locking.consistentkey中的类">ConsistentKeyLockStatus</a>&gt;</code></dd>
<dt>参数:</dt>
<dd><code>kc</code> - identifies the lock to check</dd>
<dd><code>ls</code> - the result of a prior successful <code>writeSingleLock(...)</code>
                   call on this <code>lockID</code> and <code>tx</code></dd>
<dd><code>tx</code> - identifies the process claiming this lock</dd>
<dt>抛出:</dt>
<dd><code><a href="../../BackendException.html" title="org.janusgraph.diskstorage中的类">BackendException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/InterruptedException.html" title="java.lang中的类或接口" class="external-link">InterruptedException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="deleteSingleLock(org.janusgraph.diskstorage.util.KeyColumn,org.janusgraph.diskstorage.locking.consistentkey.ConsistentKeyLockStatus,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">
<h3>deleteSingleLock</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="member-name">deleteSingleLock</span>&#8203;(<span class="parameters"><a href="../../util/KeyColumn.html" title="org.janusgraph.diskstorage.util中的类">KeyColumn</a>&nbsp;kc,
<a href="ConsistentKeyLockStatus.html" title="org.janusgraph.diskstorage.locking.consistentkey中的类">ConsistentKeyLockStatus</a>&nbsp;ls,
<a href="../../keycolumnvalue/StoreTransaction.html" title="org.janusgraph.diskstorage.keycolumnvalue中的接口">StoreTransaction</a>&nbsp;tx)</span></div>
<div class="block"><span class="descfrm-type-label">从类复制的说明:&nbsp;<code><a href="../AbstractLocker.html#deleteSingleLock(org.janusgraph.diskstorage.util.KeyColumn,S,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">AbstractLocker</a></code></span></div>
<div class="block">Try to unlock/release/delete the lock identified by <code>lockID</code> and
 both held by and verified for <code>tx</code>. This method is only called with
 arguments for which <a href="../AbstractLocker.html#writeSingleLock(org.janusgraph.diskstorage.util.KeyColumn,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)"><code>AbstractLocker.writeSingleLock(KeyColumn, StoreTransaction)</code></a>
 and <a href="../AbstractLocker.html#checkSingleLock(org.janusgraph.diskstorage.util.KeyColumn,S,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)"><code>AbstractLocker.checkSingleLock(KeyColumn, LockStatus, StoreTransaction)</code></a>
 both returned successfully (i.e. without exceptions).</div>
<dl class="notes">
<dt>指定者:</dt>
<dd><code><a href="../AbstractLocker.html#deleteSingleLock(org.janusgraph.diskstorage.util.KeyColumn,S,org.janusgraph.diskstorage.keycolumnvalue.StoreTransaction)">deleteSingleLock</a></code>&nbsp;在类中&nbsp;<code><a href="../AbstractLocker.html" title="org.janusgraph.diskstorage.locking中的类">AbstractLocker</a>&lt;<a href="ConsistentKeyLockStatus.html" title="org.janusgraph.diskstorage.locking.consistentkey中的类">ConsistentKeyLockStatus</a>&gt;</code></dd>
<dt>参数:</dt>
<dd><code>kc</code> - identifies the lock to release</dd>
<dd><code>ls</code> - the result of a prior successful <code>writeSingleLock(...)</code>
                   followed by a successful <code>checkSingleLock(...)</code></dd>
<dd><code>tx</code> - identifies the process that wrote and checked this lock</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottom-nav" id="navbar.bottom">
<div class="skip-nav"><a href="#skip.navbar.bottom" title="跳过导航链接">跳过导航链接</a></div>
<ul id="navbar.bottom.firstrow" class="nav-list" title="导航">
<li><a href="../../../../../index.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="nav-bar-cell1-rev">类</li>
<li><a href="class-use/ConsistentKeyLocker.html">使用</a></li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../../index-all.html">索引</a></li>
<li><a href="../../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>概要:&nbsp;</li>
<li><a href="#nested.class.summary">嵌套</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">字段</a>&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="sub-nav-list">
<li>详细资料:&nbsp;</li>
<li><a href="#field.detail">字段</a>&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
</div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<span class="skip-nav" id="skip.navbar.bottom">
<!--   -->
</span></nav>
<p class="legal-copy"><small>Copyright &#169; 2012&#x2013;2021. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
